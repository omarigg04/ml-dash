<div class="publications-container">
  <h2>Mis Publicaciones</h2>

  <mat-spinner *ngIf="isLoading" diameter="50"></mat-spinner>

  <div *ngIf="!isLoading" class="table-container">
    <table mat-table [dataSource]="dataSource" class="publications-table">

      <!-- Thumbnail Column -->
      <ng-container matColumnDef="thumbnail">
        <th mat-header-cell *matHeaderCellDef>Imagen</th>
        <td mat-cell *matCellDef="let item">
          <img
            [src]="item.thumbnail || 'assets/no-image.png'"
            alt="Thumbnail"
            class="thumbnail-image"
            (error)="$any($event.target).src='assets/no-image.png'"
          />
        </td>
      </ng-container>

      <!-- Title Column -->
      <ng-container matColumnDef="title">
        <th mat-header-cell *matHeaderCellDef>TÃ­tulo</th>
        <td mat-cell *matCellDef="let item" class="title-cell">
          {{ item.title }}
        </td>
      </ng-container>

      <!-- Price Column -->
      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef>Precio</th>
        <td mat-cell *matCellDef="let item">
          ${{ item.price | number:'1.2-2' }} MXN
        </td>
      </ng-container>

      <!-- Stock Column -->
      <ng-container matColumnDef="stock">
        <th mat-header-cell *matHeaderCellDef>Stock</th>
        <td mat-cell *matCellDef="let item">
          {{ item.available_quantity }}
        </td>
      </ng-container>

      <!-- Status Column -->
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>Estado</th>
        <td mat-cell *matCellDef="let item">
          <span
            class="status-badge"
            [ngClass]="'status-' + item.status"
          >
            {{ getStatusLabel(item.status) }}
          </span>
        </td>
      </ng-container>

      <!-- Actions Column -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Acciones</th>
        <td mat-cell *matCellDef="let item">
          <button
            mat-raised-button
            color="primary"
            (click)="onDuplicate(item)"
            class="action-btn"
          >
            ğŸ“‹ Duplicar
          </button>

          <button
            mat-raised-button
            color="accent"
            (click)="onRelist(item)"
            [disabled]="item.status !== 'closed'"
            class="action-btn"
          >
            ğŸ”„ Republicar
          </button>

          <button
            mat-icon-button
            (click)="onViewDetails(item)"
            matTooltip="Ver detalles"
          >
            ğŸ‘ï¸
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    <div *ngIf="dataSource.length === 0" class="no-data">
      No hay publicaciones para mostrar
    </div>
  </div>
</div>
